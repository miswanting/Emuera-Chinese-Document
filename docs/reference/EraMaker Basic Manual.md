# EraMaker Basic 中文文档

VERSION：0.1.0-200813

作者：Miswanting

作者的话：本文档是基于EraLife项目开发需要，对Emuera解释器使用方法和EraBasic语法调研后的产物。由**EraBasic 语言参考**和**Emuera 使用说明**两部分构成。具有以下特征：

- 文档结构参考并优化自Python官方文档；
- 文档中**Emuera 使用说明**部分来自作者对Emuera日文Wiki的总结归纳。

## 目录

[toc]

## 词汇表

Wiki中会使用到的词汇的定义。

伴随着Emuera的更新，定义的用语会在这里被记录。

### 启动模式

> 正常模式：双击打开程序时进入；
>
> 分析模式：将待分析的文件拖曳到程序上、或将被分析的文件路径作为程序的参数时进入；
>
> 调试模式：将`-Debug`作为程序参数时进入。

#### 正常模式

这是正常启动 Emuera 时进入的模式。

双击 EmueraXXXX.exe 时，就默认处于此模式。

#### 分析模式

把要解析的文件作为命令行参数时所启动的模式。

比如将文件拖放到 EmueraXXXX.exe 上后，它就将处于此模式。

在该模式下，将会对所分析的文件执行语法检查。

因此，您可以用这种方法看到正在开发的文件的语法错误。

但由于元素的字符串检查，您需要要使用的变体的 CSV 文件夹。TODO

您应该将文件拖放到要使用的变体的 EmueraXXXX.exe 中。

请注意，如果在 1738g 分析模式下启用了"加载时显示报告"，则现在将显示每个加载的 ERB 文件中使用的函数的列表。

如果函数太多，日志流动，请配置以增加日志中的行数。

#### 调试模式

将 -Debug 传递给命令行参数时启动的模式。详见[调试模式]()

### 窗口与对话框（Window & Dialogue）

##### 主窗口（Main Window）

一般是启动时打开的第一个窗口。

##### 主控制台（Main Console）

メインウインドウのうち、特に入出力を行う部分の名称です。

##### 调试窗口（Debug Window）

デバッグモードで起動したときに開くことが出来るウインドウのことです。

##### 调试控制台（Debug Console）

デバッグウインドウで「コンソール」タブを選択したときに表示される入出力を行う部分の名称です。

##### 设置对话框（Setting Dialogue）

メインウインドウのメニューのヘルプ、設定から開くダイアログのことです。

##### 剪贴板对话框（Clipboard Dialogue）

メインコンソールからCtrl+Cで開くダイアログのことです。

### 函数

#### 命令

PRINTやWAITなどのことです。

##### 函数

ERBスクリプト中で@～～文で名称を定義してCALL命令などで呼び出すもののことです。
式中で使える関数のうち、@～～文で名称を定義するものを含みます。

##### 事件函数

関数のうち、関数名がEVENTで始まりシステムから呼び出されるもののことです。
複数定義すれば全てが呼ばれます。

##### 预处理器

ERBフォルダ内のファイルにおいて、他の命令より先に処理をする行のことです。
\#で始まる行、もしくは[]で括られた語句からなる行がそれです。
\#で始まる行は、属性や定義に分けられます。詳しくはそちらを参照してください。
[]で括られた語句からなる行は、特殊なブロックを表すものです。
詳しくは[こちら](https://osdn.net/projects/emuera/wiki/exfunc#h3-.E7.89.B9.E6.AE.8A.E3.81.AA.E3.83.96.E3.83.AD.E3.83.83.E3.82.AF.E3.82.92.E8.A1.A8.E3.81.99.E8.A1.8C)のページを参照してください。

##### 属性（预处理器）

関数に指定する#で始まる行で、関数の仕様や動作を決定するプリプロセッサです。
イベント関数の実行時の挙動を制御するための#PRI,#LATER,#SINGLE,#ONLY,
式中関数の種別を指定するための#FUNCTION,#FUNCTIONSがあります。

##### 定义（预处理器）

\#で始まる行で、変数の名前やその仕様を定義するプリプロセッサです。
関数に指定するものにはLOCAL,LOCALS変数の要素数を指定するための#LOCALSIZE,#LOCALSSIZE,
変数を定義するための#DIM,#DIMS,　ERH中でDEFINEマクロを定義するための#DEFINEがあります。

##### 表达式中可用的函数

式中から呼び出せる「関数」です。
「関数」には上記の関数だけでなく、後述する組み込み関数を含みます。
多くのプログラミング言語では単に「関数」と呼ばれるものです。

##### 中间函数

式中で使える関数の略称です。
プログラミング言語における式中関数（匿名関数）やインライン関数とは無関係です。

##### 内置函数

式中関数のうち、Emueraにもともと組み込まれていて@～～文による定義なしで使えるものです。
ABS(X)やGETTIME()などのことです。
ややこしいですが、上記の関数の定義には該当しません。
「式中で使える命令」と考えるとわかりやすいかもしれません。

##### 用户定义的函数

ユーザーが定義した関数のことです。
ERBスクリプト中で@～～文で名称を定義してCALL命令などで呼び出すもののことです。
つまり上記の関数と同じ概念です。

##### #FUNCTION(S)函数

@～～文で名称を定義し、#FUNCTION(S)属性を持つものです。
関数かつ式中関数である関数です。

#### 行・文・式

##### 行

改行コードから次の改行コードまでのことです。
プログラミング関連では物理行とも呼ばれます。
ややこしいことにエディター関係ではこれを論理行と呼ぶことが多いです。

##### 文

文あるいは論理行はEmueraにおける1つの処理単位です。
多くの文は、命令1つとその引数、あるいは変数と代入演算子と式からなります。
ERBでは1行につき1文という鉄則のため、行と文はほぼ同じ意味です。
当Wikiでも特に区別しません。

##### 式

変数、定数、式中関数、非代入演算子、括弧とその組み合わせです。
代入演算子は代入文の最初の演算子としてのみ使用可能で式中では使えません。

##### 数式

式の評価結果（演算結果）が数値になる式です。
例えば、A+B、STR == "あいう" などです。

##### 文字列式

式の評価結果（演算結果）が文字列になる式です。
例えば、STR + STR:1、"あ" * 10 などです。

#### 变量

##### 伪变量

RANDやCHARANUMのように変数のように記述できるが実態は変数ではないものです。
内部の動作としては式中関数に近い動きをしています。

##### 数组变量

複数の要素を持つ変数です。
配列変数の要素数はVariableSize.csvで変更でき、通常はスクリプト中では増減しませんが、
一部ローカル変数については、スクリプト中で配列要素数を指定できます。

##### 字符变量

キャラクタの状態を記録する変数です。
C言語などのchar型変数とは無関係です。
その性質上、ADDCHARAやDELCHARAによるキャラの増減に伴い、要素数が増減します。
NO:TARGETなど、配列変数と同じ形式で要素を指定するためにeramakerの解説では配列変数の一つと扱われていますが、当Wikiではキャラクタ変数と配列変数とを区別しています。

##### 二维数组变量

キャラクタ変数かつ、配列変数である変数のことです。
CFLAG:TARGET:2のように、2つの引数をとります（省略可）。
キャラクタ変数なので第一引数はキャラNoを表わします。
また、キャラの増減に伴い第一次元の要素数が増減します。
第二次元の要素数はVariableSize.csvでのみ変更でき、スクリプト中では増減しません。

当Wikiではeramakerの仕様の説明を除き、"二重配列"という用語を使用しません。
代わりに"キャラクタ変数かつ配列変数"のような呼び方をします。

##### 多维数组变量

DITEMYTPEなどの二次元配列変数及びTAなどの三次元配列変数のことです。
DA:0:1やTA:1:2:3のように2つまたは3つの引数をとります。
多次元配列変数の要素数はVariableSize.csvでのみ変更でき、スクリプト中で増減しません。
また、多次元配列変数の引数は省略できません。

##### 字符多维数组变量

キャラクタ変数かつ、多次元配列変数である変数のことです。
CFLAG:TARGET:0:2のように、3つの引数をとります（省略不可）。
キャラクタ変数なので第一引数はキャラNoを表わします。
また、キャラの増減に伴い第一次元の要素数が増減します。
第二次元・第三次元の要素数はVariableSize.csvでのみ変更でき、スクリプト中では増減しません。

ver1807現在、この変数に当てはまるものは[CDFLAG](https://osdn.net/projects/emuera/wiki/exvar#h5-CDFLAG)のみです。
詳しくは[CDFLAG](https://osdn.net/projects/emuera/wiki/exvar#h5-CDFLAG)をご覧ください。

##### 局部变量

LOCALやLOCALSやプライベート変数など、関数（関数名）ごとに用意される変数です。
プライベート変数については別項を参照してください。
プライベート変数以外のLOCALやLOCALSに関しては、実際にはいわゆるローカル変数ではなく、
"LOCAL@関数名"や"LOCALS@関数名"という名のpublic staticな変数です。
関数を抜けても値は保持され関数の外からでも代入、参照できてしまいます。
また、再帰呼び出しのように複数回呼んだ場合にも値が共有されてしまいます。

##### 广域变量

LOCALやLOCALSやプライベート変数などを除くほとんどの変数が属する、すべての関数で値が共有の変数です。
一般的なプログラミング言語におけるグローバル変数の概念ともいえます。
また、ERH中で#DIMもしくは#DIMSを用いることで広域変数を定義することができます。
詳しくは[ヘッダーファイル（ERH）](https://osdn.net/projects/emuera/wiki/ERH)のページを参照してください。

##### 全局变量

異なるセーブデータ間で値を共有することができる変数です。グローバル変数も広域変数に含まれます。
通常の変数とはセーブロードや初期化のタイミングが異なります。
Emueraのグローバル変数はこれは一般的なプログラミング言語におけるグローバル変数の概念とは無関係です。

##### 私有变量

関数（関数名）ごとに#DIMもしくは#DIMSによって定義される変数です。
これらもローカル変数でありますので、関数ごとに別個のものです。
ただし、同じローカル変数とされているLOCALなどとは異なり、@関数名などを使っての関数の外からの代入、参照はできません。
詳しくは[ユーザー定義の変数](https://osdn.net/projects/emuera/wiki/UserVars)のページを参照してください。

## 调试命令（Debug Command）

## 调试模式（Debug Mode）

## _replace.csv

## 强制设置项（Config）

## 流程图

## 与EraMaker的差异

## Emuera新增的语法

